<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.552">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Kendall Allen">
<meta name="dcterms.date" content="2024-03-05">
<meta name="description" content="Seeing how Microsoft Co-Pilot Imagines Students at Different Colleges">

<title>Prompting Large Language Models - The Best Years of their Artificial Lives!</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Prompting Large Language Models</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/kendallen"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">The Best Years of their Artificial Lives!</h1>
                  <div>
        <div class="description">
          Seeing how Microsoft Co-Pilot Imagines Students at Different Colleges
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">LLMs</div>
                <div class="quarto-category">Generation</div>
                <div class="quarto-category">College</div>
                <div class="quarto-category">University stereotypes</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Kendall Allen </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 5, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p><img src="college.jpg" width="300px"></p>
<section id="envisioning-college-stereotypes" class="level1">
<h1>Envisioning College Stereotypes</h1>
<p>One of my favorite clubs I’m in at Penn is the Kite and Key society, otherwise known as Penn’s tour-guiding group. Last week, I was giving a tour and was asked, “So what is the average Penn student like?” A million things came to mind; driven, ambitious, intelligent, creative– still, I wasn’t able to give an exact answer. I couldn’t conjure up an image of a “standard” Penn kid despite having very explicit images in my head of students at other schools like Alabama or USC. It was this inability to stereotype my student body that made me curious what AI thinks of when imagining students across different colleges; here are my findings!</p>
<section id="a-sweeping-overview" class="level2">
<h2 class="anchored" data-anchor-id="a-sweeping-overview">A Sweeping Overview</h2>
<p>To begin, I wanted to ask Microsoft Co-Pilot to generate fake students using its Dalle-3 integration at many different kinds of institutions.</p>
<section id="prompt-please-generate-an-image-of-a-very-stereotypical-student-at-the-university-of-alabama." class="level4">
<h4 class="anchored" data-anchor-id="prompt-please-generate-an-image-of-a-very-stereotypical-student-at-the-university-of-alabama.">Prompt: Please generate an image of a very stereotypical student at the University of Alabama.</h4>
<p><img src="bama.png" width="300px"></p>
</section>
<section id="prompt-please-generate-an-image-of-a-very-stereotypical-student-at-the-university-of-miami-florida." class="level4">
<h4 class="anchored" data-anchor-id="prompt-please-generate-an-image-of-a-very-stereotypical-student-at-the-university-of-miami-florida.">Prompt: Please generate an image of a very stereotypical student at the University of Miami (Florida).</h4>
<p><img src="miami.png" width="300px"></p>
</section>
<section id="prompt-please-generate-an-image-of-a-very-stereotypical-student-at-harvard-university." class="level4">
<h4 class="anchored" data-anchor-id="prompt-please-generate-an-image-of-a-very-stereotypical-student-at-harvard-university.">Prompt: Please generate an image of a very stereotypical student at Harvard University.</h4>
<p><img src="harvard.png" width="300px"></p>
</section>
<section id="prompt-please-generate-an-image-of-a-very-stereotypical-student-at-howard-university." class="level4">
<h4 class="anchored" data-anchor-id="prompt-please-generate-an-image-of-a-very-stereotypical-student-at-howard-university.">Prompt: Please generate an image of a very stereotypical student at Howard University.</h4>
<p><img src="howard.png" width="300px"></p>
</section>
<section id="prompt-please-generate-an-image-of-a-very-stereotypical-student-at-the-university-of-colorado-at-boulder." class="level4">
<h4 class="anchored" data-anchor-id="prompt-please-generate-an-image-of-a-very-stereotypical-student-at-the-university-of-colorado-at-boulder.">Prompt: Please generate an image of a very stereotypical student at the University of Colorado at Boulder.</h4>
<p><img src="boulder.png" width="300px"></p>
</section>
<section id="prompt-please-generate-an-image-of-a-very-stereotypical-student-at-the-university-of-pennsylvania." class="level4">
<h4 class="anchored" data-anchor-id="prompt-please-generate-an-image-of-a-very-stereotypical-student-at-the-university-of-pennsylvania.">Prompt: Please generate an image of a very stereotypical student at the University of Pennsylvania.</h4>
<p><img src="penn.png" width="300px"></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>Immediately I see that the schools with more well-known student profiles are being represented more stereotypically. The images of Harvard and Alabama leaned into their respective intense academia and American football aesthetics, showing that Co-Pilot is aware of the general categorization of these schools. The other examples, though, were slightly more vague and generally unimpressive. Penn and UMiami fit their general campus descriptions– brick buildings and palm trees respectively– and Boulder is seen sporting a more outdoorsy, hipster outfit, but these three are definitely less defined representations of the student bodies. To see how far I could lean into key stereotypes, though, I decided to take the prompting a step further with Harvard and Bama.</p>
</div>
</div>
</section>
</section>
</section>
<section id="digging-deeper" class="level1">
<h1>Digging Deeper</h1>
<section id="prompt-please-generate-an-image-of-the-most-stereotypical-alabama-student-you-can-imagine.-this-person-basically-is-alabama" class="level4">
<h4 class="anchored" data-anchor-id="prompt-please-generate-an-image-of-the-most-stereotypical-alabama-student-you-can-imagine.-this-person-basically-is-alabama">Prompt: Please generate an image of the most stereotypical Alabama student you can imagine. This person basically IS Alabama!</h4>
<p><img src="bama2.png" width="300px"></p>
</section>
<section id="prompt-please-generate-an-image-of-the-most-stereotypical-harvard-student-you-can-imagine.-this-person-basically-is-harvard" class="level4">
<h4 class="anchored" data-anchor-id="prompt-please-generate-an-image-of-the-most-stereotypical-harvard-student-you-can-imagine.-this-person-basically-is-harvard">Prompt: Please generate an image of the most stereotypical Harvard student you can imagine. This person basically IS Harvard!</h4>
<p><img src="harvard2.png" width="300px"></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Observations
</div>
</div>
<div class="callout-body-container callout-body">
<p>Honestly, Co-Pilot didn’t go as intense on these images as I would have anticipated, but it did truly lean into the stereotypes; Alabama is depicted by a thin white girl standing outside in the warm daytime, looking enthusiastic and full of school spirit. Harvard is back in the same large library surrounded by books (+ coffee to stay focused) and seems to be a woman of Middle Eastern descent, perhaps nodding to the diversity that exists within the Harvard student body. I did notice that every student has fair skin, and not one student besides the woman from Howard– an HBCU, or historically-black college or university– is Black, Asian, or Indigenous. I don’t know the reasoning behind this, an am additionally curious about why Co-Pilot represented every student as female except for Boulder and Alabama (initially); the only tie between those schools is that they are the two state schools I listed, but I am curious as to how that links to gender.</p>
<p>To investigate this concept from one more lens, I went to ChatGPT to see how it would verbally describe average students from Alabama and Harvard.</p>
</div>
</div>
</section>
</section>
<section id="checking-in-with-chatgpt" class="level1">
<h1>Checking in with ChatGPT</h1>
<section id="prompt-describe-the-average-student-at-the-university-of-alabama." class="level4">
<h4 class="anchored" data-anchor-id="prompt-describe-the-average-student-at-the-university-of-alabama.">Prompt: Describe the average student at the University of Alabama.</h4>
</section>
<section id="response" class="level4">
<h4 class="anchored" data-anchor-id="response">Response:</h4>
<p>Stereotypes can be harmful and misleading, as they often don’t accurately represent the diverse range of individuals within any given group. However, I can provide a generalized depiction of what might be considered a stereotypical student at the University of Alabama, based on common perceptions or media portrayals. It’s essential to remember that these descriptions may not apply to every student at the university.</p>
<p>A stereotypical student at the University of Alabama might be portrayed as:</p>
<ol type="1">
<li><p>Outgoing and social: They are often seen as friendly and outgoing, embodying the spirit of Southern hospitality. They may enjoy attending social events, tailgating at football games, and participating in Greek life activities.</p></li>
<li><p>Proud of their school: They exhibit a strong sense of school spirit and pride in being a part of the Crimson Tide community. They may be frequently seen wearing university-branded clothing and enthusiastically supporting their sports teams, especially football.</p></li>
<li><p>Active in Greek life: Many stereotypical students at the University of Alabama are involved in Greek organizations, such as fraternities and sororities. These groups play a significant role in campus social life, organizing events, philanthropic activities, and networking opportunities.</p></li>
<li><p>Fashion-conscious: There might be an emphasis on appearance and style, with students paying attention to trends in clothing, accessories, and grooming. Southern preppy fashion may be prevalent among some students, reflecting a blend of traditional and modern styles.</p></li>
<li><p>Academically focused: While they enjoy the social aspects of college life, stereotypical University of Alabama students are also committed to their studies. They strive for academic success and may pursue majors in fields such as business, engineering, education, or communication.</p></li>
<li><p>Sports enthusiasts: Football, in particular, holds a special place in the hearts of many University of Alabama students. They may have a deep knowledge of the team’s history, attend games regularly, and participate in tailgating traditions with friends and family.</p></li>
<li><p>Embracing Southern culture: Stereotypical students at the University of Alabama may embrace aspects of Southern culture, including traditions, cuisine, and values. They may have a strong connection to their hometowns and families, cherishing traditions passed down through generations.</p></li>
</ol>
<p>It’s important to recognize that these characteristics represent a simplified and potentially exaggerated view of University of Alabama students. In reality, the student body is diverse, with individuals from various backgrounds, interests, and personalities. Stereotypes should not be used to make assumptions about any individual or group.</p>
</section>
<section id="prompt-describe-the-average-student-at-harvard-university." class="level4">
<h4 class="anchored" data-anchor-id="prompt-describe-the-average-student-at-harvard-university.">Prompt: Describe the average student at Harvard University.</h4>
</section>
<section id="response-1" class="level4">
<h4 class="anchored" data-anchor-id="response-1">Response:</h4>
<p>Describing the “average” Harvard student is challenging because Harvard University is renowned for its diverse and highly selective student body. However, I can provide a generalized depiction based on common perceptions and characteristics often associated with Harvard students. It’s important to note that these traits may not apply to every student at Harvard, as the university prides itself on its diversity of backgrounds, interests, and experiences.</p>
<ol type="1">
<li><p>Academic excellence: Harvard students are typically known for their exceptional intelligence, academic achievements, and intellectual curiosity. They have demonstrated outstanding academic abilities throughout their academic careers, which is one of the reasons they were admitted to such a prestigious institution.</p></li>
<li><p>Ambitious and driven: Harvard students are often perceived as highly motivated individuals with ambitious goals and aspirations. They are driven to succeed academically, professionally, and personally, and they often seek out opportunities for growth and advancement.</p></li>
<li><p>Diverse interests and talents: Harvard’s student body is incredibly diverse, both in terms of cultural backgrounds and interests. Harvard students come from all over the world and bring with them a wide range of talents, passions, and experiences, whether in the arts, sciences, humanities, or other fields.</p></li>
<li><p>Leadership potential: Many Harvard students exhibit strong leadership qualities and have held leadership positions in their schools, communities, or extracurricular activities prior to attending Harvard. They are often involved in various student organizations, clubs, and initiatives on campus.</p></li>
<li><p>Critical thinking and analytical skills: Harvard students are known for their ability to think critically, analyze complex issues, and engage in rigorous intellectual discourse. They are encouraged to question assumptions, challenge conventional wisdom, and seek innovative solutions to global challenges.</p></li>
<li><p>High levels of achievement outside the classroom: In addition to excelling academically, Harvard students often pursue a wide range of extracurricular activities, including research, internships, community service, entrepreneurship, athletics, and the arts. They are committed to making a positive impact on their communities and the world around them.</p></li>
<li><p>Collaborative and supportive: Despite their individual achievements and ambitions, Harvard students are often collaborative and supportive of one another. They recognize the value of teamwork, cooperation, and diversity of perspectives in achieving their goals and addressing complex problems.</p></li>
</ol>
<p>It’s important to recognize that these characteristics represent a broad overview and may not capture the full diversity and complexity of Harvard’s student body. Harvard students come from a wide range of backgrounds and have unique personalities, interests, and experiences that contribute to the vibrant and dynamic community at the university.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Conclusion
</div>
</div>
<div class="callout-body-container callout-body">
<p>Yeah, these seem to be pretty spot-on with stereotypical depictions of each school’s student body! It’s really interesting to consider these sweeping descriptions, though, as there are obviously incredibly academic-focused students and Alabama (ie: students on prestigious full-ride merit scholarships there) and simultaneously people at Harvard who mainly focus on sports (ie: Student athletes on any of their D1 sports teams). I think that this exercise was helpful in revealing which schools are most stereotyped and confirmed the existence of such preconceived notions. While I still wouldn’t be able to describe the “average Penn student” to a member of one of my tours, this project might have taught me that that is for the best!</p>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/kendallen\.github\.io\/comm4190_S24_Using_LLMs_Blog\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>